// 루트 프로젝트에 소스 디렉터리를 포함하지 않는 설정.
apply plugin: 'base'

allprojects  {
    apply plugin: 'maven'
    apply plugin: 'idea'
    apply plugin: 'java'

    group = 'com.jakduk'
    version = '0.7.1-SNAPSHOT'

    sourceCompatibility = 1.8
    targetCompatibility = 1.8

    configurations {
        all {
            resolutionStrategy {
                // 라이브러리 버전 충돌시 에러 경고
                failOnVersionConflict()

                force group: 'org.springframework', name: 'spring-beans', version: "${springVersion}"
                force group: 'org.springframework', name: 'spring-context', version: "${springVersion}"
                force group: 'org.springframework', name: 'spring-core', version: "${springVersion}"
                force group: 'org.springframework', name: 'spring-webmvc', version: "${springVersion}"
                force group: 'org.springframework', name: 'spring-web', version: "${springVersion}"
                force group: 'org.springframework', name: 'spring-aop', version: "${springVersion}"
                force group: 'org.springframework', name: 'spring-expression', version: "${springVersion}"
                force 'org.mongodb:mongo-java-driver:3.2.2'
                force 'org.slf4j:slf4j-api:1.7.21'
                force 'org.slf4j:jcl-over-slf4j:1.7.21'
                force group: 'com.fasterxml.jackson.core', name: 'jackson-core', version: "${jacksonVersion}"
                force group: 'com.fasterxml.jackson.core', name: 'jackson-databind', version: "${jacksonVersion}"
                force group: 'com.fasterxml.jackson.core', name: 'jackson-annotations', version: "${jacksonVersion}"
                force 'com.fasterxml:classmate:1.3.1'
                force 'commons-io:commons-io:2.4'
                force 'commons-collections:commons-collections:3.2.1'
                force 'com.google.guava:guava:19.0'
                force 'com.google.code.gson:gson:2.6.2'
                force 'commons-logging:commons-logging:1.2'
            }
        }
    }
}

subprojects {

    // test task에서 spring profile을 위한 설정.
    test {
        systemProperties = [
                'spring.profiles.active':'local'
        ]
    }

    repositories {
        mavenLocal()
        jcenter()

        // 프로젝트에 import한 jar 보관 폴더.
        flatDir {
            dirs getRootDir().path + '/custom-lib'
        }
    }

    dependencies {
        compile group: 'org.springframework', name: 'spring-context-support', version:"${springVersion}"
        compile group: 'org.springframework.security', name: 'spring-security-core', version:"${springSecurityVersion}"
        compile group: 'org.springframework.mobile', name: 'spring-mobile-device', version:'1.1.5.RELEASE'
        compile group: 'org.springframework.data', name: 'spring-data-mongodb', version:'1.9.1.RELEASE'
        compile group: 'org.springframework.data', name: 'spring-data-rest-webmvc', version:'2.5.1.RELEASE'
        compile group: 'org.mongodb', name: 'mongo-java-driver', version:'3.2.2'
        compile group: 'org.jongo', name: 'jongo', version:'1.3.0'

        compile group: 'com.fasterxml.jackson.core', name: 'jackson-core', version:"${jacksonVersion}"
        compile group: 'com.fasterxml.jackson.core', name: 'jackson-databind', version:"${jacksonVersion}"
        compile group: 'com.fasterxml.jackson.core', name: 'jackson-annotations', version:"${jacksonVersion}"
        compile group: 'org.slf4j', name: 'slf4j-api', version:'1.7.21'
        compile group: 'org.slf4j', name: 'jcl-over-slf4j', version:'1.7.21'
        compile group: 'ch.qos.logback', name: 'logback-classic', version:'1.1.7'
        compile group: 'org.hibernate', name: 'hibernate-validator', version:'5.2.4.Final'
        compile group: 'org.hibernate', name: 'hibernate-annotations', version:'3.5.6-Final'
        compile group: 'commons-fileupload', name: 'commons-fileupload', version:'1.3.2'
        compile group: 'commons-io', name: 'commons-io', version:'2.4'
        compile group: 'rome', name: 'rome', version:'1.0'
        compile group: 'org.elasticsearch', name: 'elasticsearch', version:'1.7.5'
        compile group: 'io.searchbox', name: 'jest', version:'2.0.2'
        compile group: 'net.gpedro.integrations.slack', name: 'slack-webhook', version:'1.1.1'
        compile group: 'javax.mail', name: 'mail', version:'1.4.7'
        compile 'commons-beanutils:commons-beanutils:1.9.2'
        compile 'org.freemarker:freemarker:2.3.23'

        testCompile group: 'org.springframework', name: 'spring-test', version:"${springVersion}"
        testCompile group: 'junit', name: 'junit', version:'4.12'
        testCompile 'org.mockito:mockito-all:1.10.19'

        compileOnly 'org.projectlombok:lombok:1.16.10'
    }
}
